<!DOCTYPE html>
<html>
<head>
	<title>Results</title>
    <link rel="stylesheet" type="text/css" href="../static/css/styles.css">
</head>
<body>
	<header>
		<div class="container">
			<h2>Spam Detector For SMS Messages</h2>
		  <h3>A Machine Learning App That Explains It All</h3>
		</div>
	</header>
	<div class="results">
		{% if prediction == 1%}
			<h2 style="color:#e0392d;">That was not a nice message...</h2>
		{% elif prediction == 0%}
			<h2 style="color:#4349e8;">Thank you, that <i>was</i> a nice message.</h2>
		{% endif %}
	<br><br>
	<p>
		<h3>How did the machine learning algorithm arrive at this prediction from your text?</h3>
		<br>
		Let's follow an example. Say you'd written the following message:
		<table class="table table-striped">
			<body>
				<tr>
					<td>For a chance to win a å£250 cash TXT: ACTION to 80608. U won't be sorry -visits @www.movietrivia.tv @8pm PDT!</td>
				</tr>
			</body>
		</table>
		<br>
		<h3>STEP 1: The Bag of Words</h3>
		<br>
		The first processing steps parse the text, lowering case, removing  punctuation, replacing URLs and so forth.
		<br><br>
		<button onclick="ShowDeets1()">See Details</button>
		<br>
		<div id="Deets1">
			<table class="table table-striped">
				 <thead>
			 		 <tr>
						 	<th>Step</th>
							<th>Result</th>
					</tr>
				 </thead>
				 <tbody>
						 	<tr>
								<td>Expand Contractions</td>
								<td>For a chance to win a å£250 cash TXT: ACTION to 80608. U will be sorry -visits @www.movietrivia.tv @8pm PDT!</td>
							</tr>
							<tr>
								<td>Lower Case</td>
								<td>for a chance to win a å£250 cash txt: action to 80608. u will not be sorry -visits @www.movietrivia.tv @8pm pdt!</td>
							</tr>
							<tr>
								<td>Replace URLs</td>
								<td>for a chance to win a å£250 cash txt: action to 80608. u will not be sorry -visits  URL  @8pm pdt!</td>
							</tr>
							<tr>
								<td>Replace Numbers</td>
								<td>for a chance to win a å£ NUM  cash txt: action to  NUM . u will not be sorry -visits  URL  @ NUM pm pdt!</td>
							</tr>
							<tr>
								<td>Remove Punctuation</td>
								<td>for a chance to win a å NUM cash txt action to NUM u will not be sorry visits URL NUM pm pdt</td>
							</tr>
							<tr>
								<td>Replace Emojis</td>
								<td>for a chance to win a  EMOJI  NUM cash txt action to NUM u will not be sorry visits URL NUM pm pdt</td>
							</tr>
				 </tbody>
			</table>
		</div>
		<br>
		Then the text is split into chunks of text called tokens - you can think of the as words.
		<br>
		Very common words ("stop workds") are removed as they provide little signal, and words are
		<a href="https://en.wikipedia.org/wiki/Lemmatisation">lemmatized</a> so as to arrive at simple, standard forms.
		<br>
		We then form two and three-long sequences of tokens to capture some of the order in the text - these are called Ngrams.
		<br><br>
		<button onclick="ShowDeets2()">See Details</button>
		<br>
		<div id="Deets2">
		<table class="table table-striped">
			 <thead>
		 		 <tr>
					 	<th>Step</th>
						<th>Result</th>
				</tr>
			 </thead>
		<body>
			 <tr>
				 <td>Tokenize</td>
				 <td>'for' 'a' 'chance' 'to' 'win' 'a' 'EMOJI' 'NUM' 'cash' 'txt' 'action' 'to' 'NUM' 'u' 'will' 'not' 'be' 'sorry' 'visits' 'URL' 'NUM' 'pm' 'pdt'</td>
			 </tr>
			 <tr>
				 <td>Remove Stop Words</td>
				 <td>'chance' 'win' 'EMOJI' 'NUM' 'cash' 'txt' 'action' 'NUM' 'u' 'not' 'sorry' 'visits' 'URL' 'NUM' 'pm' 'pdt'</td>
				</tr>
				<tr>
 				 <td>Lemmatize</td>
 				 <td>'chance' 'win' 'EMOJI' 'NUM' 'cash' 'txt' 'action' 'NUM' 'u' 'not' 'sorry' 'visit' 'URL' 'NUM' 'pm' 'pdt'</td>
 				</tr>
				<tr>
 				 <td>Add Ngrams</td>
 				 <td>'chance' 'win' 'EMOJI' 'NUM' 'cash' ...'for_a' 'a_chance' 'chance_to' 'to_win' 'win_a' ... 'visits_URL_NUM' 'URL_NUM_pm' 'NUM_pm_pdt'</td>
 				</tr>
		 </tbody>
	 </table>
		</div>
		<br>
 	 	Finally, we count repeated Ngrams, creating a "Bag-of-Words" representation:
		<br><br>
		<table class="table table-striped">
			 <thead>
		 		 <tr>
					 	<th>Ngram</th>
						<th>Count</th>
				</tr>
			 </thead>
		<body>
				<tr>
					<td>chance</td>
					<td>1</td>
				</tr>
				<tr>
					<td>to</td>
					<td>1</td>
				</tr>
				<tr>
					<td>win</td>
					<td>1</td>
				</tr>
				<tr>
					<td>EMOJI</td>
					<td>1</td>
				</tr>
				<tr>
					<td>NUM</td>
					<td>3</td>
				</tr>
				<tr>
					<td>cash</td>
					<td>1</td>
				</tr>
				<tr>
					<td>...</td>
					<td>...</td>
				</tr>
				<tr>
					<td>sorry_visits_URL</td>
					<td>1</td>
				</tr>
				<tr>
					<td>visits_URL_NUM</td>
					<td>1</td>
				</tr>
				<tr>
					<td>URL_NUM_pm</td>
					<td>1</td>
				</tr>
				<tr>
					<td>NUM_pm_pdt</td>
					<td>1</td>
				</tr>
			</body>
		</table>
		<br>
		<button onclick="ShowDeets3()">See Your Bag-of-Words</button>
		<br>
		<div id="Deets3">
		<table class="table table-striped">
			 <thead>
		 		 <tr>
					 	<th>Ngram</th>
						<th>Count</th>
				</tr>
			 </thead>
			 <tbody>
					{% for key, value in counter.items() %}
					 	<tr>
						 	<td>{{key}}</td>
							<td>{{value}}</td>
						</tr>
					{% endfor %}
			 </tbody>
		</table>
	</div>
		<br><br>
		<a href="https://github.com/BigBangData/SMS_SpamDetect/blob/74ca298ef7cffccca1350f852766b2401d7a4e91/custom/clean_preprocess.py#L203">Source Code</a>
	</p>
	<p>
		<br>
		<h3>STEP 2: The Document-Term Frequency Matrix</h3>
		<br><br>
		IN PROGESS...
		<br><br>
	</p>
	<script>
	function ShowDeets1() {
	  var x = document.getElementById("Deets1");
	  if (x.style.display === "block") {
	    x.style.display = "none";
	  } else {
	    x.style.display = "block";
	  }
	}
	function ShowDeets2() {
		var y = document.getElementById("Deets2");
	  if (y.style.display === "block") {
	    y.style.display = "none";
	  } else {
	    y.style.display = "block";
	  }
	}
	function ShowDeets3() {
		var y = document.getElementById("Deets3");
	  if (y.style.display === "block") {
	    y.style.display = "none";
	  } else {
	    y.style.display = "block";
	  }
	}
	</script>
</body>
</html>

<footer>
	<div>
		<ul>
			<h3><a href="/">Try Again!</a></h3>
		</ul>
	</div>
</footer>
